id: com.valvesoftware.Steam.Utility.Spout2PW
runtime: com.valvesoftware.Steam
runtime-version: stable
branch: stable
sdk: org.freedesktop.Sdk//25.08
build-extension: true
separate-locales: false

modules:
  - name: spout2pw
    buildsystem: simple
    build-commands:
      - mkdir -p ${FLATPAK_DEST}/share/spout2pw
      - cp -a . ${FLATPAK_DEST}/share/spout2pw
      - chmod +x ${FLATPAK_DEST}/share/spout2pw/spout2pw.sh
      - mkdir -p ${FLATPAK_DEST}/bin
      - ln -sf ../share/spout2pw/spout2pw.sh ${FLATPAK_DEST}/bin/spout2pw
    post-install:
      - install -Dpm0644 -t ${FLATPAK_DEST}/share/metainfo ${FLATPAK_ID}.metainfo.xml
    sources:
      - type: archive
        sha256: 3ad25c4b4eec73c4488efa4901f7928760c945192dc86f892b7d499760534f1d
        url: https://github.com/hoshinolina/spout2pw/releases/download/0.1.5/spout2pw-0.1.5-bin.tar.gz
        x-checker-data:
          type: json
          url: https://api.github.com/repos/hoshinolina/spout2pw/releases/latest
          tag-query: .tag_name
          version-query: $tag | sub("^jq-"; "")
          timestamp-query: .published_at
          url-query:
            .assets[] | select(.name == ("spout2pw-" + $tag + "-bin.tar.gz"))
            | .browser_download_url
      - type: file
        path: com.valvesoftware.Steam.Utility.Spout2PW.metainfo.xml
